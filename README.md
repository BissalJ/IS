# Fingerprint Auth Attendance App

A modern Flutter application for secure, biometric-based attendance marking using QR codes and Firebase. This app is designed for educational institutions or organizations that require robust, tamper-resistant attendance tracking.

---

## Features

- **Biometric Authentication:**
  - Users must authenticate using device biometrics (fingerprint, face, etc.) before marking attendance.
- **QR Code Session Join:**
  - Students scan a session-specific QR code to mark their attendance.
- **Secure Session Verification:**
  - Each QR code contains a signed payload (session ID, expiry, etc.) and is cryptographically verified against a public key stored in Firestore.
- **Firestore Integration:**
  - User and session data are securely stored in Firebase Firestore.
- **Device Binding:**
  - Each user account is bound to a unique device for added security.
- **Modern UI:**
  - Clean, responsive, and user-friendly interface with profile display and clear feedback.

---

## Project Structure

```
lib/
  ├── main.dart                # App entry point
  ├── login_screen.dart        # User login UI
  ├── register_page.dart       # User registration UI
  ├── main_page_screen.dart    # Main dashboard (shows name, CMS ID, attendance button)
  ├── qr_scan_screen.dart      # QR code scanner and attendance logic
  ├── auth_service.dart        # Handles authentication and user registration
  ├── auth_crypto_service.dart # Key generation, storage, and cryptography
  ├── biometric_auth_service.dart # Biometric authentication logic
  ├── secure_identification.dart   # QR decryption and signature verification
  └── ...
```

---

## Getting Started

### Prerequisites

- Flutter SDK (>=3.2.3 <4.0.0)
- Firebase project (Firestore, Authentication enabled)
- Android/iOS device with biometric hardware

### Setup

1. **Clone the repository:**
   ```sh
   git clone https://github.com/BissalJ/IS
   cd IS
   ```
2. **Install dependencies:**
   ```sh
   flutter pub get
   ```
3. **Configure Firebase:**
   - Add your `google-services.json` (Android) and `GoogleService-Info.plist` (iOS) to the respective directories.
   - Ensure your `firebase_options.dart` is generated and up to date.
4. **Run the app:**
   ```sh
   flutter run
   ```

---

## Usage

1. **Register:**
   - New users register with name, CMS ID (student ID), email, and password.
   - Each account is bound to a unique device.
2. **Login:**
   - Users log in with email and password.
3. **Main Page:**
   - Displays user's name and CMS ID.
   - "Mark Attendance" button initiates biometric authentication.
4. **Scan QR Code:**
   - After biometric auth, user scans the session QR code.
   - The app verifies the session, checks expiry, and cryptographically validates the QR code.
   - If valid, attendance is marked in Firestore under the session's `attendees` subcollection.
5. **Feedback:**
   - Users receive clear success or error messages for each step.

---

## Firestore Structure

```
users/{userId}
  - name
  - cmsId
  - email
  - deviceId
  - ...

sessions/{sessionId}
  - classId
  - expiresAt
  - publicKey
  - status ("active"/"inactive")
  - ...
  attendees/{userId}
    - name
    - cmsId
    - timestamp
```

---

## Security Notes

- **Biometric authentication** is required for marking attendance.
- **QR codes** are cryptographically signed and verified to prevent spoofing.
- **Device binding** ensures only registered devices can mark attendance for a user.
- **Firestore security rules** should be set to restrict access to authenticated users and ensure users can only write their own attendance.

---

## Customization

- You can adjust the UI colors and branding in the respective screen files.
- To add more user fields or session metadata, update the Firestore structure and registration logic.

---

## Troubleshooting

- If you see permission errors, check your Firestore security rules (see example in this README).
- Ensure your device supports biometrics and permissions are granted.
- For QR code or cryptography errors, verify the QR code is generated by your trusted backend and not expired.

---

## License

This project is for educational and demonstration purposes. Please review and adapt for production use.
